<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>NodeJS WebSocket Server</title>
</head>
<body>
	<h1>Hello world</h1>
    <table id="myTable">
        <thead>
        <tr>
            <th>My Header</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>initial row</td>
        </tr>
        </tbody>
        <tfoot>
        <tr>
            <td>My Footer</td>
        </tr>
        </tfoot>
    </table>
  <script>
    const ws = new WebSocket('ws://localhost:3001');
    ws.addEventListener("open", () =>{
        console.log("We are connected");
        ws.send("How are you?");
    });
    
    var tbodyRef = document.getElementById('myTable').getElementsByTagName('tbody')[0];

    // Insert a row at the end of table
    var newRow = tbodyRef.insertRow();

    // Insert a cell at the end of the row  
    var newCell = newRow.insertCell();

    // Append a text node to the cell
    let counter = 0;
    ws.onmessage = function (messageEvent) {
        const data = JSON.parse(messageEvent.data);
        console.log(`Neue Nachricht empfangen`, data.message)
        var newText = document.createTextNode(data.message);
        newCell.appendChild(newText);
        counter++;
        
    }
  </script>
</body>
</html>